<!doctype html>
<html id="tag-home">

<head>
  <title>Knotter</title>
  <link rel="icon" href="assets/graphics/knotter_icon_white_on_green.png">
  <link rel="stylesheet" type="text/css" href="assets/css/landing.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
</head>

<body>
  <div class="top-bar">
    <div class="logo">
      <a href="/"><img src="assets/graphics/knotter_brand_white.png" width="200px" style="float: left; "></a>
    </div class>
    <div class="nav-bar">
      <!-- <a href="/workinprogress">Plans</a>
      <a href="/workinprogress">Business</a>
      <a href="/workinprogress">About</a>
      <a href="/workinprogress">Contact Us</a> -->
      <a id="pro-button" href="/workinprogress">Link Pro</a>
    </div>
    <!-- <div class="pro-button">
      <a href="http://google.com" style="float:right">Lucidity Pro</a>
    </div> -->
    <!-- <div class="top-buttons">
      <button class="button" type="button">Login</button>
      <div class="vertical-line"></div>
      <button class="button" type="button">Sign Up</button>
    </div> -->
  </div>
  <div class="body-white">

    <div class="center-text">
      <p>Manage all your finances in one place.</p>
      <div class="action-buttons">
        <button id="login-button" class="button" style="float: left;">Login</a></button>
        <button id="sign-up-button" class="button" style="float: right; ">Sign Up</a></button>
        <!-- <button class="button" type="button">Login</button> -->
        <!-- <button class="button" type="button" style="float: right;">Sign Up</button> -->
      </div>
    </div>

    <div class="info-section">
      <div class="info-box">
        <img src="assets/graphics/hub_icon.png" width="75px;">
        <h2>Save time, reduce hassle</h2>
        <p>Link brings all of your accounts to one centralized hub.</p>
      </div>
      <div class="info-box">
        <img src="assets/graphics/exchange_icon.png" width="75px">
        <h2>Built with your privacy in mind</h2>
        <p>Your financial data is deleted as soon as you log out</p>
      </div>
      <div class="info-box">
        <img src="assets/graphics/analytics_icon.png" width="75px">
        <h2>See where your money is</h2>
        <p>Keep track of your money and receive detailed analytics on it.</p>
      </div>
    </div>

  </div>
  <div class="center-text">
    <p>Save yourself the stress</p>
  </div>
  <div>
    <p>More text</p>
  </div>

  <!-- Login modal -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <div id="login-form" class="form">
        <input id="login-name" type="text" class="form-control" name="email" placeholder="Email">
        <input id="login-pass" type="password" class="form-control" name="password" placeholder="Password">
        <button type="submit" id="login-submit" class="btn btn-warning btn-lg" onclick="login()">Login</button>
        <p class="message">Not registered? <a id="already-sign-up">Sign Up</a></p>
      </div>
    </div>
  </div>


  <!-- Sign up modal -->
  <div id="sign-up-modal" class="modal">
    <div class="modal-content">
      <div class="form">
        <form id="sign-up-form" action="/signup" method="post" class="form">
          <input id="sign-up-name" type="text" placeholder="Username" name="username" required />
          <input id="sign-up-email" type="email" placeholder="Email" name="email" required />
          <input id="sign-up-pass" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" type="password" placeholder="Password" name="password"
            required>
          <img id="hide-icon" src="assets/graphics/hide.svg" width="20px" onClick="showPass()">
          <button id="create-button">Create</button>
          <p class="message">Already registered? <a id="already-login">Login</a></p>
        </form>
      </div>
    </div>
  </div>


  <script src="assets/js/landing.js"></script>

</body>

</html>

<script>
//window.onload = env();

$('#login-submit').click(login());
$('#login-form').keyup(function(e) {
  if(e.keyCode == 13){
    login();
  }
}
);

$('#login-name').click(clear('login-name'));

function clear(elem){
  var input = document.getElementById(elem);
  console.log("clear");
  input.style.border = "none";
  input.value = "";
}

// function env(){
//   $.ajax({
//     url: "/api/env",
//     type: "GET",
//     success: function(service){
//       console.log(service);
//       var parent = document.getElementById('tag-home');
//       tag = document.createElement('p');
//       tag.innerHTML = service;
//       parent.insertBefore(tag, parent.firstChild);
//     }
//   })
// }

$.getJSON("/api/env", function(data) {
      console.log(data);
      var parent = document.getElementById('tag-home');
      tag = document.createElement('p');
      tag.innerHTML = data.env;
      parent.insertBefore(tag, parent.firstChild);

});

  function login() {
    $.ajax({
      url: "/login",
      type: "POST",
      dataType: "html",
      data: {
        email: $('#login-name').val(),
        password: $('#login-pass').val()
      },
      cache: false,
      timeout: 5000,
      success: function(data) {
        console.log(data);
        var email = document.getElementById("login-name");
        var password = document.getElementById("login-pass");
        if (data === '{"response":"authd"}') {
          window.location.replace("/");
        }
        else if (data === '{"response":"Login failed"}') {
          email.style.border = "1px solid red";
          password.style.border = "1px solid red";
          // email.value = "";
          // password.value = "";
          //password.style.border = "none";
        }
        // else if (data === '{"response":"Password is incorrect"}') {
        //   password.style.border = "1px solid red";
        //   email.style.border = "none";
        //   console.log("maybe");
        // }
      },

      error: function() {
        console.log('process error');
      },
    });
  }
</script>
